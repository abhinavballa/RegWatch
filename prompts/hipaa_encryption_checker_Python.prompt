{
  "explanation": "No dependencies were inserted because the dependencies_to_insert input was explicitly empty (no includes). The prompt already contains all required context, requirements, and referenced resources inline under the 'Dependencies' section.",
  "output_prompt": "You are implementing the HIPAA encryption compliance checker module for RegWatch. This module uses Python AST parsing to analyze source code for HIPAA ยง 164.312(a)(2)(iv) encryption violations. It validates AES-256-GCM encryption for ePHI at rest, TLS 1.2+ for data in transit, field-level PHI encryption, and key management practices (separate storage, 90-day rotation). The module returns violation reports with line numbers, regulation references, and remediation suggestions.\n\nRequirements\n\n1. Implement check_encryption_compliance(codebase_path: str) -> Dict[str, Any] that scans a codebase and returns violations list, compliance score (0-100), and estimated fine exposure\n2. Implement validate_database_encryption(ast_tree: ast.AST) -> List[Violation] to detect missing or weak database encryption (must be AES-256-GCM for ePHI)\n3. Implement validate_tls_configuration(config_files: List[str]) -> List[Violation] to ensure TLS 1.2+ is configured for data in transit\n4. Check for field-level PHI encryption in database models and ORM configurations\n5. Validate key management practices: keys stored separately from data, 90-day rotation policy enforced\n6. Each violation must include: file path, line number, HIPAA regulation reference (ยง 164.312(a)(2)(iv)), severity level, description, and remediation suggestion\n7. Implement test accumulation pattern: tests are never deleted, only added over time\n8. Handle edge cases: non-Python files gracefully, encrypted config files, environment-based configuration\n9. Use Python's ast module for static analysis without executing code\n10. Return detailed compliance report with actionable recommendations for each violation\n\nDependencies\n\n<python_ast_module_for_static_code_analysis>\n  <web>https://docs.python.org/3/library/ast.html</web>\n</python_ast_module_for_static_code_analysis>\n\n<ast_manipulation_guide_for_building_code_analyzers>\n  <web>https://greentreesnakes.readthedocs.io/en/latest/</web>\n</ast_manipulation_guide_for_building_code_analyzers>\n\n<python_cryptography_library_for_aes_256_gcm_validation>\n  <web>https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/</web>\n</python_cryptography_library_for_aes_256_gcm_validation>\n\nInstructions\n\n- Create a Violation dataclass or NamedTuple with fields: file_path, line_number, regulation, severity, description, remediation\n- Implement AST visitor classes to detect database encryption patterns (e.g., SQLAlchemy EncryptedType, Django encrypted fields)\n- Parse configuration files (YAML, JSON, .env) to validate TLS settings (ssl_version >= TLS1.2, cipher suites)\n- Scan for hardcoded encryption keys (security anti-pattern) and flag as critical violations\n- Check for key rotation logic (timestamps, version tracking)\n- Implement scoring algorithm: 100 points minus deductions per violation (critical: -25, high: -10, medium: -5, low: -2)\n- Calculate fine exposure based on violation count and severity (HIPAA fines: $100-$50,000 per violation)\n- Use pathlib for cross-platform file path handling\n- Implement comprehensive pytest test suite with fixtures for sample codebases\n- Add tests for: valid encryption, missing encryption, weak algorithms (AES-128, DES), missing TLS, hardcoded keys, valid key rotation\n- Tests must accumulate: never delete existing tests, only add new ones for new scenarios\n\nDeliverable\n\n- Python module at src/checkers/hipaa_encryption_checker.py\n- Violation dataclass/NamedTuple definition\n- Three main functions: check_encryption_compliance, validate_database_encryption, validate_tls_configuration\n- AST visitor classes for detecting encryption patterns\n- Configuration parser for TLS validation\n- Scoring and fine calculation logic\n- Comprehensive test suite in tests/test_hipaa_encryption_checker.py\n- Docstrings with examples for each public function\n\nImplementation assumptions\n\n- Target Python codebases (Django, Flask, FastAPI common frameworks)\n- Standard encryption libraries: cryptography, PyCryptodome, django-cryptography\n- Configuration formats: YAML, JSON, .env, Python config modules\n- Sample violations should include common mistakes: ECB mode, hardcoded keys, HTTP instead of HTTPS, missing field-level encryption\n\nPlease produce production-ready code that implements the HIPAA encryption compliance checker module."
}