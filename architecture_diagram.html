<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>RegWatch</title>
<script type="module">
import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({startOnLoad:true,theme:'default'});
window.addEventListener('load', () => {
    const moduleData = {"change_tracker_Python": {"filename": "change_tracker_Python.prompt", "priority": 1, "description": "Module for recording and retrieving regulation changes. Maintains logs/regulation_changes.json with timestamp, regulation ID, old/new text, affected checkers, test counts, severity level, and customer impact. Supports JSON file operations with atomic writes and historical query capabilities.", "dependencies": [], "tags": ["core", "audit", "logging"], "filepath": "src/change_tracker.py"}, "voice_service_Python": {"filename": "voice_service_Python.prompt", "priority": 2, "description": "Module for text-to-speech conversion using ElevenLabs API. Supports real-time scan narration, executive briefings, regulation change alerts, and conversational AI responses. Implements streaming for low-latency narration and batch generation for briefings. Handles voice selection (Rachel/professional tone) and audio file management.", "dependencies": [], "tags": ["core", "voice", "elevenlabs"], "filepath": "src/voice_service.py"}, "hipaa_encryption_checker_Python": {"filename": "hipaa_encryption_checker_Python.prompt", "priority": 3, "description": "PDD-generated compliance checker for HIPAA \u00a7 164.312(a)(2)(iv) encryption requirements. Uses Python AST to analyze code for database encryption at rest (AES-256+), encryption in transit (TLS 1.2+), field-level PHI encryption, and key management (separate storage, 90-day rotation). Returns violation reports with line numbers, regulation references, and remediation suggestions. Approximately 47 tests covering encryption scenarios.", "dependencies": [], "tags": ["compliance", "hipaa", "encryption", "pdd-generated"], "filepath": "src/checkers/hipaa_encryption_checker.py"}, "hipaa_access_control_checker_Python": {"filename": "hipaa_access_control_checker_Python.prompt", "priority": 4, "description": "PDD-generated compliance checker for HIPAA \u00a7 164.312(a)(1) access control requirements. Uses Python AST to detect unique user IDs, role-based access control, authentication on endpoints, session management (15-min timeout), and multi-factor auth for remote access. Returns violation reports with line numbers and remediation steps. Approximately 38 tests covering access control scenarios.", "dependencies": [], "tags": ["compliance", "hipaa", "access-control", "pdd-generated"], "filepath": "src/checkers/hipaa_access_control_checker.py"}, "hipaa_audit_logging_checker_Python": {"filename": "hipaa_audit_logging_checker_Python.prompt", "priority": 5, "description": "PDD-generated compliance checker for HIPAA \u00a7 164.312(b) audit logging requirements. Uses Python AST to verify all ePHI access is logged with timestamp, user, action, and resource. Checks log retention (6+ years), tamper-proof storage, and automated anomaly detection. Returns violation reports with line numbers and remediation guidance. Approximately 25 tests covering logging scenarios.", "dependencies": [], "tags": ["compliance", "hipaa", "audit", "pdd-generated"], "filepath": "src/checkers/hipaa_audit_logging_checker.py"}, "patient_data_validator_Python": {"filename": "patient_data_validator_Python.prompt", "priority": 6, "description": "Module for validating patient records against HIPAA data handling requirements using Pandas and Pandera. Accepts CSV uploads, checks consent form completeness, PHI encryption (SSN, medical records), access log presence, and data retention compliance. Returns list of non-compliant records with specific violations. Supports chunked processing for large datasets (50,000+ records).", "dependencies": [], "tags": ["compliance", "data", "validation"], "filepath": "src/validators/patient_data_validator.py"}, "scraper_agent_Python": {"filename": "scraper_agent_Python.prompt", "priority": 7, "description": "Toolhouse-powered agent using web_search tool to monitor HHS.gov, FDA.gov, and Federal Register for new regulatory publications. Detects regulation changes, extracts regulation text, and returns structured data with regulation ID, publication date, and full text. Uses Toolhouse SDK for automated web scraping with retry logic.", "dependencies": ["change_tracker_Python.prompt"], "tags": ["agent", "toolhouse", "monitoring"], "filepath": "src/agents/scraper_agent.py"}, "analysis_agent_Python": {"filename": "analysis_agent_Python.prompt", "priority": 8, "description": "Toolhouse-powered agent using RAG and LLM to compare old vs new regulation text. Identifies substantive changes versus clarifications, determines severity (critical/high/medium), and maps changes to affected compliance checkers. Uses semantic diff algorithms to detect meaningful regulatory updates and estimate customer impact.", "dependencies": ["change_tracker_Python.prompt"], "tags": ["agent", "toolhouse", "analysis"], "filepath": "src/agents/analysis_agent.py"}, "impact_agent_Python": {"filename": "impact_agent_Python.prompt", "priority": 9, "description": "Toolhouse-powered agent using code_execution tool to run affected checkers on customer codebases. Identifies which customers are now non-compliant, estimates remediation effort, and prioritizes by risk/fine exposure. Executes compliance checkers in isolated environments and aggregates results across multiple customers.", "dependencies": ["change_tracker_Python.prompt", "hipaa_encryption_checker_Python.prompt", "hipaa_access_control_checker_Python.prompt", "hipaa_audit_logging_checker_Python.prompt"], "tags": ["agent", "toolhouse", "impact"], "filepath": "src/agents/impact_agent.py"}, "remediation_agent_Python": {"filename": "remediation_agent_Python.prompt", "priority": 10, "description": "Toolhouse-powered agent that updates prompt files with new regulation requirements, regenerates compliance checkers via pdd sync, generates code patches for customer codebases, and creates Pull Requests using PyGithub. Implements permission modes (auto-apply, request approval, notify only) and safety guardrails for secure automated remediation.", "dependencies": ["change_tracker_Python.prompt"], "tags": ["agent", "toolhouse", "remediation", "pdd"], "filepath": "src/agents/remediation_agent.py"}, "orchestrator_Python": {"filename": "orchestrator_Python.prompt", "priority": 11, "description": "Central orchestration module that coordinates scraper, analysis, impact, and remediation agents. Manages workflow state, triggers pdd sync via GitHub Issues API, enforces permission modes and safety guardrails, and integrates with change tracker and voice service for notifications. Implements never-auto-apply rules and approval requirements.", "dependencies": ["change_tracker_Python.prompt", "voice_service_Python.prompt", "scraper_agent_Python.prompt", "analysis_agent_Python.prompt", "impact_agent_Python.prompt", "remediation_agent_Python.prompt"], "tags": ["core", "orchestration", "workflow"], "filepath": "src/orchestrator.py"}, "web_app_Python": {"filename": "web_app_Python.prompt", "priority": 12, "description": "Flask web application with blueprints for code compliance and data compliance. Implements POST /api/scan for codebase analysis, POST /api/validate-records for patient data validation, POST /api/simulate-regulation-change for demo scenarios, GET /api/change-history for audit trail, and POST /api/voice-briefing for audio summaries. Serves HTML templates with file upload, real-time progress, and results display. Uses secure file handling with zipfile extraction and cleanup.", "dependencies": ["orchestrator_Python.prompt", "hipaa_encryption_checker_Python.prompt", "hipaa_access_control_checker_Python.prompt", "hipaa_audit_logging_checker_Python.prompt", "patient_data_validator_Python.prompt", "voice_service_Python.prompt", "change_tracker_Python.prompt"], "tags": ["web", "flask", "api"], "filepath": "web/app.py"}};
    
    // Add hover listeners to all nodes
    setTimeout(() => {
        const nodes = document.querySelectorAll('.node');
        nodes.forEach(node => {
            const text = node.querySelector('.nodeLabel');
            if (!text) return;
            
            const nodeText = text.textContent.trim();
            const moduleId = nodeText.split(' ')[0];
            const data = moduleData[moduleId];
            
            if (data) {
                node.style.cursor = 'pointer';
                
                node.addEventListener('mouseenter', (e) => {
                    showTooltip(e, data);
                });
                
                node.addEventListener('mouseleave', () => {
                    hideTooltip();
                });
            }
        });
    }, 500);
});
function showTooltip(e, data) {
    hideTooltip();
    
    const tooltip = document.createElement('div');
    tooltip.id = 'module-tooltip';
    tooltip.innerHTML = `
        <div style="font-weight:600;margin-bottom:8px;font-size:1.1em;">${data.filename}</div>
        <div style="margin-bottom:6px;"><strong>Priority:</strong> ${data.priority}</div>
        <div style="margin-bottom:6px;"><strong>Path:</strong> ${data.filepath}</div>
        <div style="margin-bottom:6px;"><strong>Tags:</strong> ${data.tags.join(', ')}</div>
        <div style="margin-bottom:6px;"><strong>Dependencies:</strong> ${data.dependencies.length > 0 ? data.dependencies.join(', ') : 'None'}</div>
        <div style="margin-top:8px;padding-top:8px;border-top:1px solid #ddd;font-size:0.9em;color:#444;">${data.description}</div>
    `;
    
    document.body.appendChild(tooltip);
    
    const rect = e.target.closest('.node').getBoundingClientRect();
    tooltip.style.left = rect.right + 10 + 'px';
    tooltip.style.top = rect.top + window.scrollY + 'px';
}
function hideTooltip() {
    const existing = document.getElementById('module-tooltip');
    if (existing) existing.remove();
}
</script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui,sans-serif;background:#fff;color:#000;padding:2rem;max-width:1400px;margin:0 auto}
h1{font-size:2rem;font-weight:600;margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid #000}
.diagram{border:1px solid #000;padding:2rem;margin:2rem 0;overflow-x:auto;position:relative}
.mermaid{display:flex;justify-content:center}
#module-tooltip{
    position:absolute;
    background:#fff;
    border:2px solid #000;
    padding:1rem;
    max-width:400px;
    z-index:1000;
    box-shadow:4px 4px 0 rgba(0,0,0,0.1);
    font-size:0.9rem;
    line-height:1.5;
}
.node{transition:opacity 0.2s}
.node:hover{opacity:0.8}
</style></head><body>
<h1>RegWatch</h1>
<div class="diagram"><pre class="mermaid">flowchart TB
        PRD["RegWatch"]
    
    subgraph Backend
        web_app_Python["web_app_Python (12)"]
    end
    
    subgraph Shared
        change_tracker_Python["change_tracker_Python (1)"]
        voice_service_Python["voice_service_Python (2)"]
        hipaa_encryption_checker_Python["hipaa_encryption_checker_Python (3)"]
        hipaa_access_control_checker_Python["hipaa_access_control_checker_Python (4)"]
        hipaa_audit_logging_checker_Python["hipaa_audit_logging_checker_Python (5)"]
        patient_data_validator_Python["patient_data_validator_Python (6)"]
        scraper_agent_Python["scraper_agent_Python (7)"]
        analysis_agent_Python["analysis_agent_Python (8)"]
        impact_agent_Python["impact_agent_Python (9)"]
        remediation_agent_Python["remediation_agent_Python (10)"]
        orchestrator_Python["orchestrator_Python (11)"]
    end
    
    PRD --> Backend

    scraper_agent_Python -->|uses| change_tracker_Python
    analysis_agent_Python -->|uses| change_tracker_Python
    impact_agent_Python -->|uses| change_tracker_Python
    impact_agent_Python -->|uses| hipaa_encryption_checker_Python
    impact_agent_Python -->|uses| hipaa_access_control_checker_Python
    impact_agent_Python -->|uses| hipaa_audit_logging_checker_Python
    remediation_agent_Python -->|uses| change_tracker_Python
    orchestrator_Python -->|uses| change_tracker_Python
    orchestrator_Python -->|uses| voice_service_Python
    orchestrator_Python -->|uses| scraper_agent_Python
    orchestrator_Python -->|uses| analysis_agent_Python
    orchestrator_Python -->|uses| impact_agent_Python
    orchestrator_Python -->|uses| remediation_agent_Python
    web_app_Python -->|uses| orchestrator_Python
    web_app_Python -->|uses| hipaa_encryption_checker_Python
    web_app_Python -->|uses| hipaa_access_control_checker_Python
    web_app_Python -->|uses| hipaa_audit_logging_checker_Python
    web_app_Python -->|uses| patient_data_validator_Python
    web_app_Python -->|uses| voice_service_Python
    web_app_Python -->|uses| change_tracker_Python
    
    classDef frontend fill:#FFF3E0,stroke:#F57C00,stroke-width:2px
    classDef backend fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    classDef shared fill:#E8F5E9,stroke:#388E3C,stroke-width:2px
    classDef system fill:#E0E0E0,stroke:#616161,stroke-width:3px
    
    class web_app_Python backend
    class change_tracker_Python,voice_service_Python,hipaa_encryption_checker_Python,hipaa_access_control_checker_Python,hipaa_audit_logging_checker_Python,patient_data_validator_Python,scraper_agent_Python,analysis_agent_Python,impact_agent_Python,remediation_agent_Python,orchestrator_Python shared
    class PRD system</pre></div>
</body></html>